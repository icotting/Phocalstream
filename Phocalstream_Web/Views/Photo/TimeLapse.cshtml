@model Phocalstream_Web.Models.ViewModels.TimelapseModel


@{
    ViewBag.Title = "";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>TimeLapse</h2>
    <form id="form1" runat="server" style="width: 800px; height: 600px">
        <div style="height: 100%;" id="silverlightControlHost">
        <object data="data:application/x-silverlight-2," type="application/x-silverlight-2" width="100%" height="100%">
		  <param name="source" value="/ClientBin/Phocalstream_TimeLapse.xap"/>
		  <param name="onError" value="onSilverlightError" />
		  <param name="background" value="white" />
		  <param name="minRuntimeVersion" value="4.0.60310.0" />
		  <param name="autoUpgrade" value="true" />
          <param name="initParams" value="encodedVideo=@Html.DisplayFor(m => m.EncodedFrames)" />
		  <a href="http://go.microsoft.com/fwlink/?LinkID=149156&v=4.0.60310.0" style="text-decoration:none">
 			  <img src="http://go.microsoft.com/fwlink/?LinkId=161376" alt="Get Microsoft Silverlight" style="border-style:none"/>
		  </a>
	    </object><iframe id="_sl_historyFrame" style="visibility:hidden;height:0px;width:0px;border:0px"></iframe></div>
    </form>

<video autobuffer="autobuffer" autoplay="autoplay" loop="loop" controls="controls">
    <source src='@ViewBag.destination' type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'>
</video>

@*
<div style="position: relative; top: 0px; left: 0px;">
@foreach (Phocalstream_Web.Models.TimelapseFrame frame in Model.Frames)
{
    <div id="photo:@Html.Raw(frame.photo.ID)" style="width: 800px; height: 600px; position: absolute; top: 0px; left: 0px; display: block;">
        <script type="text/javascript">
            viewer = new Seadragon.Viewer('photo:@Html.Raw(frame.photo.ID)');
            viewer.clearControls();
            viewer.tracker.clickHandler = function (tracker, position, quick, shift) {
                return;
            };
            viewer.addEventListener("open", function() { 
                readyCount++;
            });
            viewer.openDzi("@Html.DisplayFor(model => frame.Url)");
            containers.push(viewer);
        </script>
    </div>
    }
    <div  style="position: absolute; top: 0px; right: 0px;">
        <input id="speed" type="text" value="100" onchange="speed = this.value;" />
    </div>

</div> *@